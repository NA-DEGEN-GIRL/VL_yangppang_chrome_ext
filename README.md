# Hedge Trading Helper - Chrome Extension

Lighter와 Variational 거래소에서 동시에 반대 포지션(헤지) 주문을 실행하고, 실시간 포지션 정보를 모니터링하며, 포지션 불균형을 자동으로 해결하는 고급 트레이딩 보조 도구입니다.

## 🎯 목표

두 거래소 간의 가격 차이를 이용한 차익 거래 또는 헤지 트레이딩 전략 실행 시, 수동 작업을 최소화하고 복잡한 주문 로직을 자동화하여 사용자의 편의성을 극대화하는 것을 목표로 합니다.

---

## ✨ 주요 기능

### 📊 실시간 모니터링
- **포지션 정보**: 각 거래소의 포지션 크기, 미실현 손익(PnL), 펀딩 수수료를 실시간으로 표시합니다.
- **계좌 잔액**: 각 거래소별 잔액 및 두 계좌의 총 합계를 USD 형식으로 표시합니다.
- **자동 갱신**: 모든 정보는 1초마다 자동으로 업데이트되어 항상 최신 상태를 유지합니다.

### 🚀 주문 실행 및 자동화
- **수동 주문**: 
  - `Quantity` 필드에 수량을 입력하고 `L-Buy / V-Sell` 또는 `L-Sell / V-Buy` 버튼으로 주문 방향을 설정합니다.
  - `Submit ALL Orders` 버튼으로 양쪽 거래소에 한 번에 주문을 제출합니다.
- **Lighter 오더북 연동**:
  - `Lighter Orderbook` 드롭다운에서 오더북의 특정 위치(Index)를 선택하여 Lighter 거래소의 지정가(Limit) 주문 가격을 설정할 수 있습니다.
  - `X (Off)` 선택 시 시장가(Market)로 설정됩니다.
- **오더북 가격 자동 새로고침**:
  - `Price Refresh` 기능으로 Lighter 오더북의 최신 가격을 설정된 시간(ms)마다 자동으로 클릭하여 지정가 주문의 경쟁력을 유지합니다.
- **🤖 자동 헤지 (Auto limit L -> market V)**:
  - `Delta` 임계값 기반의 자동 헤지 기능입니다. 양쪽 거래소의 순 포지션(Net-Position)이 델타 값을 초과할 경우, Variational에 자동으로 시장가 주문을 제출하여 포지션 불균형을 해소합니다.
  - `Lock Timeout` 기능으로 헤지 주문 후 일정 시간 동안 추가 주문을 방지하여 중복 실행을 막습니다. 
- **🔁 자동 주문 반복 (Auto Submit All)**:
  - **반복 클릭**: 'Submit ALL Orders' 버튼을 지정된 횟수만큼 자동으로 클릭합니다.
  - **랜덤 간격**: 클릭 간의 간격을 사용자가 설정한 최소-최대 시간(초 단위) 사이에서 매번 랜덤하게 설정하여, 보다 인간적인 패턴으로 주문을 실행합니다.
  - **실시간 상태**: 진행 상황 (남은 클릭 횟수)을 실시간으로 표시하며, 언제든지 중지할 수 있습니다.

### 🔧 편의 기능
- **코인 페어 동시 변경**: 팝업에서 코인 심볼을 설정하면 열려 있는 두 거래소 탭의 트레이딩 페어가 동시에 변경됩니다.
- **설정 자동 저장**: 수량, 코인 심볼, 각종 자동화 설정값은 로컬에 자동 저장되어 팝업을 다시 열어도 유지됩니다.

---

## 🚀 설치 및 설정
1. 이 저장소를 로컬 컴퓨터에 클론하거나 다운로드합니다.
2. Chrome 브라우저에서 `chrome://extensions` 주소로 이동합니다.
3. 우측 상단의 '개발자 모드(Developer mode)'를 활성화합니다.
4. '압축 해제된 확장 프로그램을 로드합니다(Load unpacked)' 버튼을 클릭하고, 다운로드한 `chrome_extension` 폴더를 선택합니다.
5. 브라우저 툴바에 확장 프로그램 아이콘이 나타납니다.

---

## 📖 사용 가이드

### 1. 수동 주문
1.  Lighter와 Variational 거래소 탭을 각각 하나씩 열어둡니다.
2.  팝업 상단의 `Coin` 입력 필드에 거래할 코인 심볼(예: `ETH`)을 입력하고 `Set` 버튼을 누릅니다.
3.  `Quantity` 필드에 주문할 수량을 입력합니다. (`setQuantity`도 자동으로 실행됩니다.)
4.  `L-Buy, V-Sell` 또는 `L-Sell, V-Buy` 버튼을 눌러 양 거래소의 주문 방향을 설정합니다.
5.  `Submit ALL Orders` 버튼을 클릭하여 양쪽에 주문을 제출합니다.

### 2. 오더북 가격 자동 새로고침 (Lighter 지정가)
1. `Lighter Orderbook` 드롭다운에서 원하는 가격의 위치(Index)를 선택합니다.
2. `Price Refresh` 필드에 새로고침할 시간 간격(ms)을 입력합니다. (예: 200)
3. 수동 주문 방향을 먼저 선택한 후 `Start` 버튼을 눌러 자동 새로고침을 시작/중지합니다.

### 3. 자동 헤지 (Auto limit L -> market V)
1. `Delta`: 헤지를 시작할 순 포지션의 크기(절대값)를 설정합니다.
2. `Interval`: 순 포지션을 확인할 시간 간격(ms)을 설정합니다.
3. `Lock Timeout (s)`: 헤지 주문 후 중복 실행을 방지할 잠금 시간(초)을 설정합니다.
4. `Auto limit L -> market V` 버튼을 눌러 자동 헤지를 시작/중지합니다. (사전에 수동 주문 방향이 선택되어 있어야 합니다)

### 4. 자동 주문 반복
1.  **수동 주문 준비**: 위 '수동 주문' 가이드의 1~4단계를 따라 코인, 수량, 주문 방향을 미리 설정합니다. (주문 제출은 아직 하지 않습니다)
2.  **파라미터 설정**:
    - `Total`: `Submit ALL Orders`를 클릭할 총 횟수.
    - `Min(s)` / `Max(s)`: 클릭 간의 최소 및 최대 랜덤 대기 시간 (초 단위).
3.  **자동 반복 시작**: `Auto Submit All` 버튼을 클릭하여 시작합니다.
    - 버튼이 'STOP Auto Submit'으로 바뀌고 'Status'에 진행 상황이 표시됩니다.
4.  **자동 반복 중지**: `STOP Auto Submit` 버튼을 다시 클릭하여 언제든지 중지할 수 있습니다.

---

## ⚠️ 중요 주의사항
- 이 확장 프로그램은 실제 자산을 거래하는 데 사용될 수 있습니다. **사용으로 인해 발생하는 모든 금전적 손실에 대한 책임은 사용자 본인에게 있습니다.**
- 코드를 충분히 이해하고, **반드시 소액으로 테스트**한 후 사용하십시오.
- 웹사이트의 UI가 변경되면 스크립트가 오작동할 수 있습니다. `lighter.js`와 `variational.js`의 DOM 셀렉터를 주기적으로 확인하고 업데이트해야 할 수 있습니다.

---

## 🐛 문제 해결 (Troubleshooting)
- **정보가 업데이트되지 않음**: Lighter, Variational 탭이 올바르게 열려 있는지 확인하세요. 또는 `chrome://extensions`에서 확장 프로그램을 새로고침 해보세요.
- **버튼이 클릭되지 않음**: 거래소 웹사이트의 UI 업데이트로 인해 버튼이나 입력 필드의 선택자(selector)가 변경되었을 수 있습니다. `lighter.js`와 `variational.js` 내부의 `document.querySelector` 부분을 확인하고 수정해야 합니다.

---

## 📜 라이선스
MIT License
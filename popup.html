<!DOCTYPE html>
<html>
<head>
    <title>Hedge Trader</title>
    <style>
        body { 
            font-family: sans-serif; 
            width: 320px; 
            padding: 8px; 
            font-size: 12px; 
            margin: 0;
        }
        .input-group, .button-group { 
            margin-bottom: 4px;
        }
        .control-section {
            border: 1px solid #ddd;
            padding: 5px;
            border-radius: 4px;
            background-color: #f9f9f9;
            margin-bottom: 5px;
        }
        label { 
            display: block; 
            margin-bottom: 2px;
            font-weight: bold; 
        }
        input[type="text"], input[type="number"], select { 
            width: 100%; 
            padding: 3px;
            box-sizing: border-box; 
        }
        button { 
            width: 100%; 
            padding: 5px;
            margin-top: 2px;
            cursor: pointer; 
            border: 1px solid #ccc; 
            border-radius: 4px; 
            background-color: #f0f0f0; 
        }
        .button-group { 
            display: flex; 
            gap: 4px; 
        }
        hr { 
            border: 0; 
            border-top: 1px solid #ccc; 
            margin: 6px 0;
        }
        .info-table { 
            width: 100%; 
            border-collapse: collapse; 
            margin-bottom: 6px;
            font-size: 11px;
        }
        .info-table th, .info-table td { 
            border: 1px solid #ddd; 
            padding: 3px;
            text-align: right; 
        }
        .info-table th { background-color: #f2f2f2; text-align: center; }
        .info-table td:first-child { text-align: left; font-weight: bold; }
        #balance-table .total-row td { font-weight: bold; }
        
        .flex-row { 
            display: flex; 
            align-items: center; 
            gap: 6px;
            margin-top: 4px; 
        }
        .flex-row input { width: 55px; }
        .toggle-btn, #autoLimitHedgeBtn, #autoSubmitToggleBtn {
            background-color: #4CAF50; 
            color: white; 
            border: none; 
        }
        .toggle-btn.active, #autoLimitHedgeBtn.active, #autoSubmitToggleBtn.active {
            background-color: #f44336; 
        }
        #autoHedgeStatus, #autoSubmitStatus {
            font-size: 10px;
            text-align: center; 
            margin-top: 3px;
            color: #555; 
            height: 1em;
        }
    </style>
</head>
<body>
    <div class="input-group">
        <div class="button-group">
            <input type="text" id="coinSymbol" placeholder="BTC">
            <button id="setCoinBtn">Set</button>
        </div>
    </div>

    <table id="position-table" class="info-table">
        <thead>
            <tr>
                <th>Exchange</th>
                <th>Size</th>
                <th>PnL</th>
                <th>Funding</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Lighter</td>
                <td id="lighter-size">0.0000</td>
                <td id="lighter-pnl">0.0</td>
                <td id="lighter-funding">0.0</td>
            </tr>
            <tr>
                <td>Variational</td>
                <td id="variational-size">0.0000</td>
                <td id="variational-pnl">0.0</td>
                <td id="variational-funding">0.0</td>
            </tr>
        </tbody>
    </table>

    <table id="balance-table" class="info-table">
        <thead>
            <tr>
                <th>Exchange</th>
                <th>Balance</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Lighter</td>
                <td id="lighter-balance">$0.00</td>
            </tr>
            <tr>
                <td>Variational</td>
                <td id="variational-balance">$0.00</td>
            </tr>
            <tr class="total-row">
                <td>Total Balance</td>
                <td id="total-balance">$0.00</td>
            </tr>
        </tbody>
    </table>

    <hr>
    
    <div class="input-group">
        <label for="quantity">Quantity:</label>
        <input type="text" id="quantity" placeholder="0.001">
    </div>

    <div class="button-group">
        <button id="lBuyVSell">L-Buy, V-Sell</button>
        <button id="lSellVBuy">L-Sell, V-Buy</button>
    </div>

    <div class="control-section">
        <div class="input-group" style="margin-bottom: 4px;">
            <label for="orderbookIndex">Lighter Orderbook (X = Off):</label>
            <select id="orderbookIndex">
                <option value="X">X (Off)</option>
                <option value="0">0</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
            </select>
        </div>
        <div class="flex-row">
            <label for="priceRefreshInterval" style="font-weight: normal;">Price Refresh:</label>
            <input type="number" id="priceRefreshInterval" min="100" max="5000" value="200" step="100">
            <span>ms</span>
            <button id="autoPriceUpdateToggle" class="toggle-btn">Start</button>
        </div>
    </div>
    
    <div class="control-section">
        <button id="autoLimitHedgeBtn">Auto limit L -> market V</button>
        <div class="flex-row">
            <label for="deltaThreshold" style="font-weight: normal;">Delta:</label>
            <input type="text" id="deltaThreshold" value="0.001" style="width: 70px;">
            <label for="hedgeInterval" style="font-weight: normal;">Interval:</label>
            <input type="number" id="hedgeInterval" min="100" max="5000" value="500" step="100">
        </div>
        <div class="flex-row">
            <label for="lockTimeout" style="font-weight: normal;">Lock Timeout (s):</label>
            <input type="number" id="lockTimeout" min="1" max="60" value="5" step="1">
        </div>
        <p id="autoHedgeStatus" style="font-size: 10px;">Status: Idle</p>
    </div>

    <div class="control-section">
        <button id="autoSubmitToggleBtn">Auto Submit All</button>
        <div class="flex-row">
            <label for="autoSubmitTotal" style="font-weight: normal;">Total:</label>
            <input type="number" id="autoSubmitTotal" value="10" min="1" step="1" style="width: 45px;">
            <label for="autoSubmitIntervalMin" style="font-weight: normal;">Min(s):</label>
            <input type="number" id="autoSubmitIntervalMin" value="0.5" min="0.01" step="0.01" style="width: 45px;">
            <label for="autoSubmitIntervalMax" style="font-weight: normal;">Max(s):</label>
            <input type="number" id="autoSubmitIntervalMax" value="1.5" min="0.01" step="0.01" style="width: 45px;">
        </div>
        <p id="autoSubmitStatus" style="font-size: 10px;">Status: Idle</p>
    </div>

    <button id="submitOrder" style="margin-top: 6px;">Submit ALL Orders</button>
    <div class="button-group">
        <button id="submitLighter">Submit L</button>
        <button id="submitVariational">Submit V</button>
    </div>

    <script src="popup.js"></script>
</body>
</html>